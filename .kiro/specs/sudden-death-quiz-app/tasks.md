# 実装タスクリスト

- [ ] 1. プロジェクト基盤とインフラ設定
  - プロジェクトディレクトリ構造の作成（frontend, backend, infra）
  - Docker開発環境の構築（docker-compose.yml, Dockerfile）
  - Go mod初期化とGin基本設定
  - Next.js プロジェクト初期化とTypeScript設定
  - Firebase プロジェクト設定とEmulator構成
  - _要件: 6.3, 6.4_

- [ ] 2. バックエンド基盤実装
  - [ ] 2.1 Clean Architecture基盤構築
    - ディレクトリ構造作成（handler, usecase, domain, repository）
    - 基本的なインターフェース定義（Repository, UseCase）
    - 設定管理システム実装（config.go）
    - _要件: 全般的な基盤_
  
  - [ ] 2.2 ドメインエンティティ実装
    - Session, User, Question, Answer エンティティ作成
    - バリデーション機能付きドメインモデル実装
    - エンティティ単体テスト作成
    - _要件: 1.1, 2.1, 7.1_
  
  - [ ] 2.3 Firebase Repository実装
    - Firestore接続とクライアント初期化
    - QuizRepository, UserRepository インターフェース実装
    - CRUD操作とエラーハンドリング
    - Repository層の単体テスト作成
    - _要件: 7.1, 7.2_

- [ ] 3. AI問題生成システム実装
  - [ ] 3.1 AI Client インターフェース設計
    - AIClient インターフェース定義
    - Strategy パターンでの切り替え機構実装
    - エラーハンドリングとフォールバック機能
    - _要件: 3.1, 3.2, 3.5_
  
  - [ ] 3.2 Gemini API クライアント実装
    - Gemini API連携コード作成
    - 問題生成プロンプト設計と実装
    - レート制限とエラー処理実装
    - Geminiクライアント単体テスト作成
    - _要件: 3.1, 3.3, 3.4_
  
  - [ ] 3.3 OpenAI/Claude フォールバック実装
    - OpenAI API クライアント実装
    - Claude API クライアント実装
    - AI Service での自動切り替えロジック
    - フォールバック機能の統合テスト作成
    - _要件: 3.2, 3.5_

- [ ] 4. WebSocketリアルタイム通信実装
  - [ ] 4.1 WebSocket Hub管理システム
    - Hub, Client 構造体実装
    - クライアント登録・削除・ブロードキャスト機能
    - セッション別クライアント管理
    - WebSocket接続の単体テスト作成
    - _要件: 6.1, 6.2_
  
  - [ ] 4.2 メッセージ配信システム
    - 問題配信、回答受信、結果通知のメッセージ定義
    - リアルタイム参加者数更新機能
    - 接続エラー時の再接続処理
    - メッセージ配信の統合テスト作成
    - _要件: 6.1, 6.2, 6.4_

- [ ] 5. クイズ進行ロジック実装
  - [ ] 5.1 セッション管理UseCase
    - セッション作成・取得・更新機能
    - 参加者登録・脱落・復活処理
    - セッション状態管理（waiting, active, finished）
    - セッション管理の単体テスト作成
    - _要件: 1.2, 2.1, 4.2_
  
  - [ ] 5.2 サドンデス進行ロジック
    - ラウンド進行とクイズ配信機能
    - 回答判定と正解者・不正解者分類
    - 脱落処理と次ラウンド進出判定
    - サドンデス進行の統合テスト作成
    - _要件: 2.1, 2.2, 2.3, 2.4_
  
  - [ ] 5.3 敗者復活戦システム
    - 脱落者からのランダム復活選出機能
    - 復活者の現在ラウンド再参加処理
    - 復活通知とクライアント更新
    - 敗者復活戦の単体テスト作成
    - _要件: 4.1, 4.2, 4.3, 4.4_

- [ ] 6. REST API エンドポイント実装
  - [ ] 6.1 クイズ参加者向けAPI
    - POST /sessions/{id}/join - セッション参加
    - GET /sessions/{id}/status - セッション状態取得
    - POST /sessions/{id}/answers - 回答送信
    - 参加者API の単体テスト作成
    - _要件: 1.1, 1.3, 1.4_
  
  - [ ] 6.2 管理者向けAPI
    - POST /admin/sessions - セッション作成
    - PUT /admin/sessions/{id}/control - 進行制御（開始・停止・スキップ）
    - POST /admin/sessions/{id}/revival - 敗者復活戦実行
    - GET /admin/sessions/{id}/results - 結果取得
    - 管理者API の単体テスト作成
    - _要件: 5.1, 5.2, 5.3, 5.5_

- [ ] 7. フロントエンド基盤実装
  - [ ] 7.1 プロジェクト構造とルーティング
    - Atomic Design ディレクトリ構造作成
    - Next.js ページルーティング設定（/, /admin, /result）
    - TypeScript型定義ファイル作成
    - 基本レイアウトコンポーネント実装
    - _要件: 6.5_
  
  - [ ] 7.2 状態管理とカスタムHook
    - Zustand ストア設定（quiz, user, admin）
    - useAuth, useQuiz, useWebSocket カスタムHook実装
    - Firebase Auth 匿名ログイン機能
    - 状態管理の単体テスト作成
    - _要件: 1.1, 6.1_
  
  - [ ] 7.3 WebSocket通信クライアント
    - WebSocket接続管理サービス実装
    - リアルタイムメッセージ受信処理
    - 接続エラー時の自動再接続機能
    - WebSocket通信の統合テスト作成
    - _要件: 6.1, 6.2, 6.4_

- [ ] 8. 参加者向けUI実装
  - [ ] 8.1 Atomic Design コンポーネント
    - Button, Input, Loading 等のAtoms実装
    - QuestionCard, UserList 等のMolecules実装
    - QuizBoard, ParticipantsList 等のOrganisms実装
    - UIコンポーネントのStorybook設定とテスト
    - _要件: 1.3, 6.5_
  
  - [ ] 8.2 クイズ参加画面実装
    - Container-Presenter パターンでQuizContainer実装
    - 問題表示と選択肢UI実装
    - 制限時間表示とカウントダウン機能
    - 回答送信と結果表示機能
    - クイズ画面の統合テスト作成
    - _要件: 1.3, 1.4, 1.5_
  
  - [ ] 8.3 参加者状態表示機能
    - リアルタイム参加者数表示
    - 自分の状態表示（参加中・脱落・復活）
    - ラウンド進行状況表示
    - 参加者状態UIのテスト作成
    - _要件: 6.1, 6.2_

- [ ] 9. 管理者向けダッシュボード実装
  - [ ] 9.1 管理者認証とルーティング
    - 管理者用認証機能実装
    - 管理者ページのアクセス制御
    - 管理者用レイアウトコンポーネント
    - 認証機能の単体テスト作成
    - _要件: 5.1_
  
  - [ ] 9.2 セッション管理UI
    - セッション作成・設定フォーム実装
    - 参加者一覧表示とCSV一括登録機能
    - セッション状態制御UI（開始・停止・スキップ）
    - セッション管理UIの統合テスト作成
    - _要件: 5.4, 5.5_
  
  - [ ] 9.3 リアルタイム監視ダッシュボード
    - 現在の参加者数・ラウンド状況表示
    - 勝ち残り者リアルタイム表示
    - 敗者復活戦実行ボタンとUI
    - 結果表示とCSVエクスポート機能
    - 監視ダッシュボードの統合テスト作成
    - _要件: 5.1, 5.2, 5.3, 7.3, 7.4_

- [ ] 10. データ分析と結果表示機能
  - [ ] 10.1 結果集計システム
    - 各ラウンドの結果集計機能実装
    - 参加者成績計算とランキング生成
    - 統計情報生成（正解率、平均回答時間等）
    - 結果集計の単体テスト作成
    - _要件: 7.2, 7.4_
  
  - [ ] 10.2 結果表示画面
    - 最終結果表示ページ実装
    - ランキング表示とアニメーション
    - 個人成績詳細表示
    - CSVエクスポート機能実装
    - 結果表示の統合テスト作成
    - _要件: 7.3, 7.4_

- [ ] 11. エラーハンドリングと最適化
  - [ ] 11.1 包括的エラーハンドリング
    - フロントエンド統一エラーハンドリング実装
    - バックエンドエラーミドルウェア実装
    - ユーザーフレンドリーなエラーメッセージ表示
    - エラーハンドリングの統合テスト作成
    - _要件: 3.5, 6.4_
  
  - [ ] 11.2 パフォーマンス最適化
    - 200人同時接続の負荷テスト実行
    - WebSocket接続プール最適化
    - フロントエンド画像・リソース最適化
    - レスポンス時間改善とキャッシュ実装
    - _要件: 6.3_

- [ ] 12. CI/CDとデプロイ設定
  - [ ] 12.1 GitHub Actions CI/CD
    - Lint チェック、テスト実行のワークフロー作成
    - Docker イメージビルドとプッシュ設定
    - ステージング環境への自動デプロイ設定
    - CI/CD パイプラインのテスト実行
    - _要件: 全般的な品質保証_
  
  - [ ] 12.2 GCP Cloud Run デプロイ
    - Cloud Run サービス設定とデプロイ
    - 環境変数とシークレット管理
    - カスタムドメイン設定とSSL証明書
    - 本番環境での動作確認テスト
    - _要件: 6.3_

- [ ] 13. 統合テストと最終調整
  - [ ] 13.1 エンドツーエンドテスト
    - 完全なクイズフロー統合テスト作成
    - 複数参加者同時参加シナリオテスト
    - 敗者復活戦を含む全機能テスト
    - パフォーマンステストと負荷テスト実行
    - _要件: 全要件の統合検証_
  
  - [ ] 13.2 本番環境最終調整
    - 本番データベース設定と初期データ投入
    - 監視・ログ設定とアラート構成
    - セキュリティ設定とアクセス制御確認
    - 本番環境での最終動作確認
    - _要件: 7.5, 全般的な運用準備_